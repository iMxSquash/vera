<div class="p-8 max-w-6xl mx-auto">

  <!-- Upload Section -->
  <div class="mb-8">
    <input type="file" id="file-upload" accept="image/*" (change)="onFileSelected($event)" hidden />
    <label for="file-upload"
      class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-700 text-white rounded-lg font-semibold cursor-pointer transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5">
      <ng-container *ngIf="uploading(); else uploadBtn">
        <span class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
        <span>Upload en cours...</span>
      </ng-container>
      <ng-template #uploadBtn>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        <span>Ajouter une image</span>
      </ng-template>
    </label>
  </div>

  <!-- Error Message -->
  <div *ngIf="error()" class="p-4 bg-red-100 border-l-4 border-red-500 rounded text-red-700 flex gap-3 mb-8">
    {{ error() }}
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading()" class="flex flex-col items-center justify-center py-16">
    <div class="w-10 h-10 border-4 border-slate-300 border-t-purple-600 rounded-full animate-spin mb-4"></div>
    <p class="text-gray-600">Chargement des images...</p>
  </div>

  <!-- Grid -->
  <div *ngIf="!isLoading() && images().length > 0" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <div *ngFor="let image of images(); trackBy: trackById"
         class="relative aspect-square rounded-2xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-xl"
         [class.opacity-60]="!image.isActive">
      <img [src]="image.supabaseUrl" class="w-full h-full object-cover" />

      <div class="absolute inset-0 bg-black/40 opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-center justify-center gap-4">
        <!-- Toggle -->
        <button class="p-3 bg-white rounded-full shadow-lg hover:scale-110" (click)="toggleStatus(image.id)">
          <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.88 9.88l4.24 4.24m-4.24 0l4.24-4.24"></path>
          </svg>
        </button>

        <!-- Delete -->
        <button class="p-3 bg-red-500 rounded-full shadow-lg hover:scale-110" (click)="deleteImage(image.id)">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0117 21H7a2 2 0 01-1.995-1.858L4 7m5 4v6m4-6v6M1 1l22 22"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading() && images().length === 0" class="flex flex-col items-center justify-center py-16 text-center">
    <p class="text-xl font-semibold text-gray-800 mb-2">Aucune image de référence</p>
    <p class="text-gray-600">Ajoutez votre première image pour commencer</p>
  </div>

</div>
