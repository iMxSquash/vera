<div class="mx-auto p-8">
    <!-- Upload Zone -->
    @if (!previewUrl()) {
    <div class="relative flex items-center justify-center md:w-[50vw] md:h-[30vw] max-w-[800px] max-h-[350px] border-2 border-dashed border-[#C3E4A1] bg-white rounded-2xl p-16 text-center transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5"
        (drop)="onDrop($event)" (dragover)="onDragOver($event)">
        <input type="file" id="file-input" accept="image/*" (change)="onFileSelected($event)" hidden />
        <label for="file-input" class="cursor-pointer flex flex-col items-center">
            <svg width="39" height="39" viewBox="0 0 39 39" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_315_303)">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M1.70623 10.725C2.58373 10.725 2.07998 9.84753 2.01498 6.15878C2.01498 3.41253 1.85248 2.42128 4.93998 1.96628C6.67873 1.72253 8.56373 1.96628 10.3025 1.88503C10.4552 1.86066 10.5942 1.78264 10.6945 1.665C10.7949 1.54736 10.85 1.39779 10.85 1.24316C10.85 1.08852 10.7949 0.938955 10.6945 0.821311C10.5942 0.703667 10.4552 0.625654 10.3025 0.601281C7.23123 0.357531 3.86748 -1.07247 0.812482 1.62503C-0.926268 3.25003 0.812482 8.27128 1.10498 10.2375C1.12136 10.3814 1.19353 10.513 1.30597 10.6042C1.41841 10.6953 1.56213 10.7387 1.70623 10.725Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M10.3025 37.115C8.56375 37.0337 6.67875 37.2775 4.94 37.0337C1.83625 36.5787 1.96625 35.5712 2.015 32.8412C2.015 29.1687 2.58375 28.3562 1.70625 28.275C1.55797 28.266 1.41205 28.3153 1.29969 28.4125C1.18734 28.5097 1.11746 28.6469 1.105 28.795C0.747498 30.875 -0.942502 35.8312 0.812498 37.375C3.85125 40.0237 7.215 38.61 10.3187 38.3662C10.4546 38.3261 10.5736 38.2426 10.6577 38.1286C10.7418 38.0145 10.7863 37.8761 10.7844 37.7344C10.7826 37.5928 10.7345 37.4556 10.6475 37.3438C10.5605 37.2319 10.4394 37.1516 10.3025 37.115Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M28.6975 1.88492C30.4363 1.96617 32.3213 1.72242 34.06 1.96617C37.1475 2.42117 37.0338 3.41242 36.985 6.15867C36.985 9.84742 36.4163 10.6437 37.2938 10.7249C37.3676 10.7316 37.4421 10.7233 37.5127 10.7005C37.5833 10.6778 37.6487 10.6411 37.7048 10.5925C37.7609 10.544 37.8066 10.4847 37.8393 10.4181C37.872 10.3515 37.8909 10.279 37.895 10.2049C38.2525 8.12492 39.9425 3.24992 38.1875 1.62492C35.1488 -1.05633 31.785 0.35742 28.6813 0.60117C28.5288 0.627407 28.3907 0.707152 28.2918 0.826075C28.1929 0.944998 28.1396 1.0953 28.1416 1.24998C28.1435 1.40466 28.2006 1.55356 28.3025 1.66995C28.4044 1.78633 28.5444 1.86255 28.6975 1.88492Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M37.375 28.275C36.4975 28.3562 37.0012 29.1525 37.0662 32.8412C37.0662 35.5712 37.245 36.5787 34.1413 37.0337C32.4025 37.2775 30.5175 37.0337 28.7787 37.115C28.626 37.1393 28.487 37.2174 28.3867 37.335C28.2863 37.4526 28.2312 37.6022 28.2312 37.7568C28.2312 37.9115 28.2863 38.061 28.3867 38.1787C28.487 38.2963 28.626 38.3743 28.7787 38.3987C31.8662 38.6425 35.2787 40.0237 38.285 37.4075C40.0237 35.7825 38.285 30.9075 37.9925 28.795C37.9864 28.7202 37.9655 28.6473 37.9311 28.5807C37.8967 28.514 37.8494 28.4547 37.792 28.4064C37.7346 28.3581 37.6682 28.3216 37.5966 28.299C37.5251 28.2765 37.4497 28.2683 37.375 28.275Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M16.25 12.9999C15.8934 12.7172 15.4568 12.5543 15.0022 12.5343C14.5476 12.5143 14.0983 12.6383 13.7183 12.8887C13.3383 13.139 13.0471 13.5028 12.886 13.9284C12.7249 14.3539 12.7023 14.8195 12.8212 15.2587C12.8063 15.3302 12.8056 15.4039 12.8192 15.4757C12.8327 15.5474 12.8603 15.6158 12.9003 15.6769C12.9402 15.738 12.9919 15.7907 13.0522 15.8318C13.1125 15.873 13.1804 15.9019 13.2519 15.9168C13.3234 15.9317 13.3971 15.9324 13.4689 15.9189C13.5406 15.9053 13.609 15.8778 13.6701 15.8378C13.7312 15.7978 13.7839 15.7462 13.825 15.6858C13.8662 15.6255 13.8951 15.5577 13.91 15.4862C13.91 15.3724 15.4375 14.2024 15.795 14.2512C15.9609 14.3115 16.144 14.3035 16.304 14.2288C16.464 14.1541 16.5878 14.019 16.6481 13.853C16.7085 13.6871 16.7004 13.504 16.6257 13.344C16.5511 13.184 16.4159 13.0603 16.25 12.9999Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M19.5 13.8451L21.3363 13.1464C21.5231 13.0692 21.7202 13.02 21.9213 13.0001C21.9992 13.0311 22.0824 13.0464 22.1662 13.0451C22.25 13.0439 22.3327 13.0262 22.4097 12.993C22.4866 12.9598 22.5563 12.9118 22.6147 12.8517C22.6731 12.7915 22.7191 12.7205 22.75 12.6426C22.781 12.5647 22.7963 12.4815 22.795 12.3977C22.7938 12.3139 22.7761 12.2312 22.7429 12.1542C22.7097 12.0772 22.6617 12.0076 22.6016 11.9492C22.5414 11.8908 22.4704 11.8448 22.3925 11.8139C22.0857 11.5201 21.7027 11.3181 21.287 11.2307C20.8713 11.1434 20.4394 11.1742 20.0403 11.3196C19.6412 11.4651 19.2907 11.7194 19.0287 12.0537C18.7666 12.388 18.6034 12.7891 18.5575 13.2114C18.4832 13.3363 18.4595 13.485 18.4914 13.6269C18.5233 13.7687 18.6083 13.893 18.729 13.9741C18.8496 14.0552 18.9968 14.0871 19.1402 14.0631C19.2836 14.0391 19.4123 13.9611 19.5 13.8451Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M21.125 17.8749C21.1422 17.7068 21.092 17.5388 20.9853 17.4078C20.8787 17.2767 20.7243 17.1934 20.5562 17.1762C20.3882 17.1589 20.2201 17.2092 20.0891 17.3158C19.958 17.4225 19.8747 17.5768 19.8575 17.7449C19.8048 17.9091 19.7183 18.0605 19.6035 18.1892C19.4888 18.318 19.3483 18.4213 19.1912 18.4924C18.3458 18.6066 17.4856 18.4651 16.7212 18.0862C16.6767 18.0194 16.6186 17.9628 16.5507 17.92C16.4827 17.8773 16.4065 17.8494 16.327 17.8383C16.2476 17.8271 16.1666 17.8329 16.0895 17.8552C16.0124 17.8776 15.941 17.916 15.8798 17.9679C15.8186 18.0199 15.7691 18.0842 15.7345 18.1566C15.7 18.2291 15.6812 18.308 15.6793 18.3882C15.6774 18.4685 15.6926 18.5482 15.7237 18.6222C15.7548 18.6961 15.8013 18.7627 15.86 18.8174C17.3387 21.9212 21.32 21.0112 21.125 17.8749Z"
                        fill="black" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M29.5425 32.1424C29.6271 32.1424 29.7109 32.1255 29.7888 32.0927C29.8668 32.0598 29.9374 32.0117 29.9965 31.9511C30.0555 31.8905 30.1019 31.8187 30.1328 31.7399C30.1636 31.6612 30.1784 31.577 30.1763 31.4924C30.5988 26.2762 28.6813 23.3674 25.7725 21.3362C26.8376 20.3322 27.6214 19.067 28.0459 17.6662C28.4704 16.2655 28.5208 14.778 28.1922 13.3517C27.8635 11.9254 27.1673 10.61 26.1726 9.53623C25.1779 8.46247 23.9195 7.66778 22.5225 7.23116C13.6825 4.06241 4.55001 12.3012 10.0588 20.5074C10.8609 21.7058 11.9145 22.715 13.1463 23.4649C10.4163 25.3012 8.74251 27.6249 8.84001 32.7112C8.84992 32.8676 8.91606 33.0152 9.02622 33.1268C9.13638 33.2383 9.28315 33.3063 9.43948 33.3182C9.59581 33.3301 9.75117 33.285 9.87691 33.1914C10.0027 33.0978 10.0903 32.9618 10.1238 32.8087C10.7711 29.5555 12.2809 26.536 14.495 24.0662C15.2826 24.3957 16.1275 24.5669 16.9813 24.5699C17.0629 24.5839 17.1465 24.5798 17.2264 24.5581C17.3063 24.5363 17.3805 24.4974 17.4438 24.444C17.5071 24.3906 17.5579 24.3241 17.5928 24.249C17.6277 24.1739 17.6458 24.0921 17.6458 24.0093C17.6458 23.9265 17.6277 23.8447 17.5928 23.7696C17.5579 23.6945 17.5071 23.628 17.4438 23.5746C17.3805 23.5212 17.3063 23.4823 17.2264 23.4605C17.1465 23.4388 17.0629 23.4347 16.9813 23.4487C16.1563 23.3796 15.3543 23.1417 14.625 22.7499C12.8889 21.9273 11.5284 20.4781 10.817 18.6936C10.1056 16.909 10.096 14.9213 10.79 13.1299C13.1138 8.25491 21.1575 7.21491 24.8788 11.2124C28.6 15.2099 25.7725 21.7424 20.4425 22.7499C20.2949 22.7984 20.1696 22.8981 20.0892 23.031C20.0088 23.1638 19.9786 23.3211 20.0041 23.4743C20.0297 23.6275 20.1092 23.7665 20.2284 23.8662C20.3476 23.9658 20.4985 24.0194 20.6538 24.0174C22.1627 23.7975 23.5897 23.1932 24.7975 22.2624C26.15 23.8967 27.2159 25.7483 27.95 27.7387C29.25 31.1674 28.5513 32.1587 29.5425 32.1424Z"
                        fill="black" />
                </g>
                <defs>
                    <clipPath id="clip0_315_303">
                        <rect width="39" height="39" fill="white" />
                    </clipPath>
                </defs>
            </svg>

            <p class="text-[13px] lg:text-[24px]">
                Clique pour t√©l√©charger une photo de toi
            </p>
        </label>
    </div>
    }

    <!-- Preview Zone -->
    @if (previewUrl() && !resultImageUrl()) {
    <div class="flex flex-col gap-6 animate-fade-in">
        <img [src]="previewUrl()" alt="Preview"
            class="w-full max-h-96 object-contain rounded-2xl shadow-2xl transition-transform duration-300 hover:scale-105" />

        <div class="flex flex-col gap-4">
            <button
                class="inline-block text-vera-primary bg-neutrals-900 text-[14px] lg:text-[20px] border border-black rounded-full px-[24px] py-[8px]"
                (click)="submitFaceSwap()" [disabled]="isLoading()">
                @if (isLoading()) {
                <span class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
                <span>Traitement en cours...</span>
                } @else {
                G√©n√©rer ma deepfake
                }
            </button>
            <button class="flex-1 px-6 py-3 bg-neutrals-50 rounded-full border-2 border-black" (click)="reset()"
                [disabled]="isLoading()">
                Recommencer
            </button>
        </div>

        @if (result()) {
        <div class="">
            <span class="inline-block px-4 py-2 rounded-full text-sm font-semibold"
                [class]="result()!.status === 'Completed' ? 'bg-green-200 text-green-800' : result()!.status === 'Failed' ? 'bg-red-200 text-red-800' : 'bg-yellow-200 text-yellow-800'">
                {{ result()!.status }}
            </span>
        </div>
        }
    </div>
    }

    <!-- Result Zone -->
    @if (resultImageUrl()) {
    <div class="flex flex-col gap-6 animate-fade-in">
        <h3 class="text-2xl font-bold text-gray-800">‚ú® R√©sultat</h3>
        <img [src]="resultImageUrl()" alt="Result"
            class="w-full max-h-96 object-contain rounded-2xl shadow-2xl transition-transform duration-300 hover:scale-105" />

        <div class="flex gap-4">
            <a [href]="resultImageUrl()" download="face-swap-result.jpg" target="_blank" rel="noopener noreferrer"
                class="flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-neutrals-50 rounded-lg font-semibold transition-all duration-300 hover:shadow-lg text-center">
                üì• T√©l√©charger
            </a>
            <button
                class="flex-1 px-6 py-3 bg-slate-200 text-gray-800 rounded-lg font-semibold transition-all duration-300 hover:shadow-lg"
                (click)="reset()">
                Nouvelle image
            </button>
        </div>
    </div>
    }

    <!-- Error Display -->
    @if (error()) {
    <div class="p-4 bg-red-100 border-l-4 border-red-500 rounded text-red-700 flex gap-3">
        <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        {{ error() }}
    </div>
    }
</div>